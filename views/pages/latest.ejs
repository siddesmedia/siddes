<h3 class="header">The Latest</h3>
<div class="postdivnohover sortby" style="border-bottom: none;">
    <span>Sort By</span>
    <button class="button" onclick="opentab('posts')">Posts</button>
    <button class="button" onclick="opentab('users')">Users</button>
</div>
<div id="posts" class="tab">
    <% for(var i = 0; i < posts.length; i++) { %>
    <div class="postcontainer">
        <div class="postdiv">
            <% if(posts[i].sensitive == true) { %>
            <div class="sensitivepost" style="cursor: pointer;" onclick="window.location='/s/<%= posts[i]._id %>'">
                <span class="postownerlink">This post contains edgy material, click to view at your own
                    risk. A moderator has approved it.</span>
            </div>
            <% } else { %>
            <div style="cursor: pointer;" onclick="window.location='/s/<%= posts[i]._id %>'">
                <% if (posts[i].approved == true) { %>
                <span class="commentsmeta right">
                    <button class="button" type="button" class="postreport">Approved</button>
                </span>
                <% } else { if (posts[i].reported == true) { %>
                <span class="commentsmeta right">
                    <button class="button" type="button" class="postreport">Under Review</button>
                </span>
                <% } else { %>
                <span class="commentsmeta right">
                    <button class="button" onclick="window.location='/report?post=<%= posts[i]._id %>'" type="button"
                        class="postreport"><a class="nostyle"
                            href="/report?post=<%= posts[i]._id %>">Report</a></button>
                </span>
                <% }} %>
                <p class="postowner">
                    <a class="postownerlink" id="user_<%= i.toString() %>_<%= posts[i]._id %>"
                        href="/account/<%= posts[i].owner %>">
                    </a>
                    <% if(posts[i].repost == 'true') { %>
                    <span class="repostbadge">Repost</span>
                    <% } else {} %>
                </p>
                <p class="postbody" id="post_<%= posts[i]._id %>">
                    <%= posts[i].body %>
                </p>
                <% if(posts[i].media == true) { %>
                <img class="postimage" src="/usergenerated/images/<%= posts[i]._id %>" loading="lazy"><br>
                <span>
                    <a href="/usergenerated/images/<%= posts[i]._id %>" download class="postbody smalltext">Download
                        Image</a>
                </span><br><br>
                <% } %>
                <!--<p class="postmeta">
                    <%= posts[i].date.toLocaleString() %>
                </p>-->
            </div>
            <div class="post_bottom_buttons">
                <span class="seeallcommentsbutton">
                    <button class="button" type="button" onclick="window.location='/s/<%= posts[i]._id %>#comments'">See
                        All
                        Comments</button>
                </span>
                <span class="right">
                    <span class="modbuttons">
                        <% if(moderator == true) { if(posts[i].approved == true) { %>
                        <button class="button" onclick="removepost('<%= posts[i]._id %>')" type="button">Mod: Remove
                            Post</button>
                        <% } else { %>
                        <button class="button" onclick=" removepost('<%= posts[i]._id %>')" type="button">Mod: Remove
                            Post</button>
                        <button class="button" onclick=" approvepost('<%= posts[i]._id %>')" type="button">Mod: Approve
                            Post</button>

                        <% }} %>
                    </span>
                    <button
                        onclick="window.location='/account/new?text=<%- encodeURIComponent(posts[i].body) %>&repost=true'"
                        type="button" class="postrepost button">Repost</button>
                    <span id="likebutton_<%= posts[i]._id %>">

                    </span>
                </span>
                <form action="/comment/new" method="POST" class="left">
                    <input class="postcommentinput input" name="body" type="text" style="width:63%" autocomplete="off"
                        required placeholder="Thoughts...">
                    <input name="parentid" type="text" style="width:0%" class="hidden input" value="<%= posts[i]._id %>"
                        required="required">
                    <button type="submit" class="postcomment button">Comment</button>
                </form>
            </div>
            <% } %>
        </div>
    </div>
    <script>
        replacepostlinks('post_<%= posts[i]._id %>')
        getusername('user_<%= i.toString() %>_<%= posts[i]._id %>', '<%= posts[i].owner %>')
        haveiliked('likebutton_<%= posts[i]._id %>', '<%= posts[i].likes.length %>', '<%= posts[i]._id %>',
            '<%= loggedin %>')
    </script>
    <% } %>
</div>
<div style="display: flex;justify-content: center;" class="postdiv">
    <style>
        .pagination {
            padding-left: 10px;
            padding-right: 10px;
            margin: 5px;
        }
    </style>
    <% if(page == 0) { %>
    <button onclick="window.location='/latest/<%= page-1 %>'" disabled class="button pagination">...</button>
    <% if (lastpage == true ) { %>
    <button onclick="window.location='/latest/<%= eval(page)+1 %>'" class="button pagination" disabled>...</button>
    <% } else { %>
    <button onclick="window.location='/latest/<%= eval(page)+1 %>'"
        class="button pagination"><%= eval(page)+2 %></button>
    <% } %>
    <% } else if (lastpage == true ) { %>
    <button onclick="window.location='/latest/<%= page-1 %>'" class="button pagination"><%= page %></button>
    <button onclick="window.location='/latest/<%= eval(page)+1 %>'" class="button pagination" disabled>...</button>
    <% } else { %>
    <button onclick="window.location='/latest/<%= page-1 %>'" class="button pagination"><%= page %></button>
    <button onclick="window.location='/latest/<%= eval(page)+1 %>'"
        class="button pagination"><%= eval(page)+2 %></button>
    <% } %>
</div>